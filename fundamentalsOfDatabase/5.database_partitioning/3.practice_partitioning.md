> let's first create a table marks with id and grade column
> - ```docker run --name pgmain -d -e POSTGRES_PASSWORD=postgres postgres ``` - detach we want to use another terminal , and -e to set the enivronment variable
> - ```docker exec -it pgmain bash``` executing the container in bash interactive terminal
> - ```psql -U postgress``` now enter in postgress using password you entered
> - ```create table marks(id serial not null, g int not null);``` creating table
> - let's insert data inside this table ```insert into marks(g) select floor(random()*100) from generate_series(0,10000000)```

> so to do the partition we will do the following step"
> - create main table on which we will do partitioning , ```create table marks_partition (id serial not null, g int not null) partition by range(g);```
> - now that main partition table is ready we will create partition table while will store range of datas
> - ```create table m0035 (like marks_partition including indexes);```
> - ```create table m3560 (like marks_partition including indexes);```
> - ```create table m6080 (like marks_partition including indexes);```
> - ```create table m80100 (like marks_partition including indexes);```
> - now once we are done with creating partition table with all range where which data will go to which table
> - now its time to attach these partition table to main table which is marks_partition table
> - ```alter table marks_partition attach partition m0035 for values from (0) to (35);```
> - ```alter table marks_partition attach partition m3560 for values from (35) to (60);```
> - ```alter table marks_partition attach partition m6080 for values from (60) to (80);```
> - ```alter table marks_partition attach partition m80100 for values from (80) to (100);```
> - now once attachment of paartition to main partition table is done
> - now the amazing thing is that when we try inserting row in to this table , any row that goes to the table will automatically be segregated and goes to table where it belongs let's row with g value 90 will go to m80100 table
> - try inserting marks table data in to marks_partition, ```insert into marks_partition select * from marks;```
> - now run the query to check the number of rows you get in marks_parition must 10million
> - now again run the query to check number of rows on m0035 , you will see the values between 0 to 35
> - when queried ```select max(g) from m0035;```

<img src="https://github.com/user-attachments/assets/3d2f05ae-8021-46cd-8654-15881b5c25a6">

> now what about adding indexing to the partition
>- do i need to add partition to all the table , well that was the case with postgres older than postgres 11 but now we can only create the indexing on main table i.e., marks_partition
>- ```create index marks_partition_g_idx on marks_partition(g);```
>- describe the marks_partition table using ```\d marks_parition ``` although this marks_partition table is just a virtual table if you create index here all the other partition will also have the indexes

<img width=800 height=400 src="https://github.com/user-attachments/assets/525d1f43-2f51-4fb1-a059-e87f788c3ec2">


> querying and checking the size of the partition
> - ```explain analyze select count(*) from marks_partition where g=30;```
> - as we can see in the image , it onyl hit m0035 table as g=30 will always reside in the m0035 table 

<img width=800 height=400 src="https://github.com/user-attachments/assets/2d4b43fa-70ff-43d1-82a2-072f9483962d">

>-  to get the size of all the indexes in our table use command ```select pg_relation_size(oid), relname from pg_class order by pg_relation_size(oid) desc;```
>-  you will see the size of previous marks table was way more than the partitioned table
>- there is another variable in postgres called  ENABLE_PARTITION_PRUNING ```show ENABLE_PARTITION_PRUNING;``` if you turn this variable off ```set ENABLE_PARTITION_PRUNING=off; ```
>-  then if you run ```explain select count(*) from marks_partition where g=30; ``` you will see , postgress will look through all the partition to get the values , basically when this variable is off partitioning will not work
