### Data migration
- moving data from one setup to another

### Data replication 
- keeping multiple copies of data
- everytime data comes it will be replicated to copy of db
- write will be performed to primary db
- and read can be performed from both the db

### Advantage
- falut tolerance (if primary db goes down copy of the db can become primary)
- Improved read speeds
- simple

### Disadvantage
- consistency (one db where we are writing , copy of the db might have stale data for some time)
- write speed will be slower as it will also write in the copy of db

<img width="400" height="600" alt="image" src="https://github.com/user-attachments/assets/fa954a0a-f3f2-4b79-90c8-aaec0732772a" />

### How does primary-replica architecture work?
<img width="400" height="600" alt="image" src="https://github.com/user-attachments/assets/367d24c7-0716-4bdb-bb54-20066ae82a04">

- there are a lot variations here , if we want to read uncommitted data, or i'm not going to finish the log before i complete the read operations
- it depends on db to db and your configuration of the database also, but eventually these nodes are consistent
- you can do three operation on both of them , you can think of these operations like a log of operations, set of statements that you have to execute in your db to ensure both db are consistent
- again if 4th operation x = x+20 comes primary db will send this operation to replica , and replica send the ack to primary , i have recevied it , now if you have something else you can send , now replica will execute these statements and this is called **write ahead log** (WAL)
- what we are doing is , we are copying the WAL of one db to another
- the best thing about it , you can sequentially execute the operations and also roll them back like you do in transactions

### Advantage of WAL
- sequence of actions that happened in the DB, we are just moving it to another db
- can be replayed multiple times and rolled back
- another advantage is you are not copying or moving large chunk of data at once , but you are only moving the operations

- if replica doesnt catch up to you, you may have consistency issue
- Timestamps are tricky 10:00 is what store in primary and replica received at 10:03
- operations like x = x+10 and replica receives x = x+5 this is very rare, but just an example,  where the time of operation or sequence of operation that happened before determine the resultant operation in the replica.
- the solution for above is called change data capture, places where you want to perform certain operations with context, use change data capture solutions
- you can think of data capture solution as a message queue, when you send a message and subscriber pulls it , and does something based on the message , in the previous WAL we were blindly copying the operations
- so this use case is ideal when you have different types of databases, which are sources and destinations.
- lets say when you want to write to cassandra for some reason and for replica you want some relational queries to be fired on this database cassandra is not idea for this, so make a copy of this in RDS(Relational databases) all write will be copied here
- the writes are all copied into the reads and the solution for this , the message to that you imagine here is called change data capture

### Advantage of Change data capture 
- Ideal for cross database replication
- allows transformation of data from source to destination
- can have many different type and number of suscribers / replicas
