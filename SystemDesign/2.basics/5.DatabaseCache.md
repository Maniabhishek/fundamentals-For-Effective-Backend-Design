### we have noticed now that our application is getting slower and responses are quick 
- lets debug , first thing lets check the CDN whether that is having any issue , usually it wont have as it is globally distributed and this seems perfectly fine
- here while fetching data or list of tshirts is slower , what we can do here improve the latency
- whenever we talk about the latency to improve , first thing we should think of bringing data closer to the user
- we can do it by caching

### there are multiple places we can do the caching 
- while fetching the products , we can asynchronously load the t-shirts data, we wont actually get the images and all which can be fetched from CDN directly which will be faster
- caching can also be done on server side

### Two way we can do caching 
- in memory caching
- centralized caching 

### In memory cache 
- we have n numbers of server we need to keep the data at n places
- it has advantages , like simple to implement , extremely fast
- disadvantages restarting the requires re-popoulating the cache
- difficult to maintain the consistency across all the caches (if itemid with 1 has count 5 which is stored in all the servers now if from one of the server one item is purchased count decreases to 4 now this value has to somehow updated to all the servers)

 ### Cewntralized Cache
 - data duplication is much lesser
 - scaling the cache is easier

### How is data distributed among servers
- as your system scales you one single server is not enough to serve
- what kind of data should we store , well whatever hte server asks for
- indian server ask for fetch the tshirt , us server ask from us cache fetch us tshirt , now if us server asks for indian thsirt fetch from server and store it there in cache
- with this we may have some duplication in both the cache , to reduce this we can load us cache us thsirt and indian t shirt in indian based on type of country this is called **sharding**
- now if us server asks for indian tshirt then go fetch it from db or from indian cache
- now lets say us server is heavy and load has incread then we increase the cache server from 1 to 2 and 2 to 3
- now if requesting an item with id = 124 which cache srever has this item , how will we know, well we can either distribute the caching based on ids lets say from 0 -1000 goes in server 1 and 1000 -2000 goes to server 2 and 2000-3000 goest to server 3
- this way can identify the cache server
- even beter can hash item id lets 124 and server count we have is so hashing of 124 % 3 = 1 goes to server this now matter which id comes we will be able to hash and get the server which store this id
- but what will happen if one of the server goes down , lets say server 2 goes down all the hashing of item id which was 2 will not have any server
- how do we handle this kind of situation , well simplest approach can be , we can distribute such request equally to all the servers 50% to server-1 and 50% to server-2
- the problem with this is whenever you loss or add a server we need to load some data to the server , this happens when you add a server during the increase in load time or you decrease when it either crashes itself of you reomve it , everytime we need to load the data to these server , now this is a prolem , **cache readiness or warmup takes a lot of time** some time it can take minutes of hr depending on the amount of data, for example facebook memcached if you do it using simple algorithm it will take hrs

    <img width="501" height="252" alt="image" src="https://github.com/user-attachments/assets/dec3cb8e-c13f-4a10-9d81-9430052ee70d" />

- what is solution for this Problem , we will use **CONSISTENT HASHING**
- whole idea of consistent hashing is to reduce the amount of update or data loading you need, this way you dont need to wait for so long for the data to be loaded
- lets understand consistent hashing

<img width=400 height=400 src="https://github.com/user-attachments/assets/bd7535b2-564c-44a5-a999-f09e7db2013f">

<img width=400 height=400 src="https://github.com/user-attachments/assets/fe641d6a-47c1-4b40-8bee-391b5dedffed">

<img width=400 height=400 src="https://github.com/user-attachments/assets/1d2c9085-b281-4bca-9bc6-ebfd11160195">

